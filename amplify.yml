version: 1
frontend:
  phases:
    preBuild:
      commands:
        - echo "ğŸš€ Iniciando build do AGROISYNC Frontend no Linux..."
        - echo "ğŸ“‹ InformaÃ§Ãµes do sistema:"
        - uname -a
        - echo "ğŸ“‹ VersÃµes do ambiente:"
        - node --version
        - npm --version
        - echo "ğŸ“‹ DiretÃ³rio atual:"
        - pwd
        - echo "ğŸ“¦ Instalando dependÃªncias..."
        - cd frontend && npm ci
        - echo "âš™ï¸ Configurando Next.js para Amplify..."
        - cp next.config-final.js next.config.js
        - cp tsconfig-amplify.json tsconfig.json
        - echo "ğŸ”§ ConfiguraÃ§Ãµes aplicadas com sucesso"
        - echo "ğŸ“ Estrutura atual:"
        - ls -la
        - echo "ğŸ“ Verificando arquivos de configuraÃ§Ã£o:"
        - ls -la next.config*.js
        - ls -la tsconfig*.json
    build:
      commands:
        - echo "ğŸ—ï¸ Buildando aplicaÃ§Ã£o..."
        - npm run build
        - echo "ğŸ“ Verificando estrutura apÃ³s build..."
        - pwd
        - ls -la
        - echo "ğŸ“ Verificando pasta out..."
        - ls -la out/
        - echo "ğŸ“„ Verificando index.html..."
        - ls -la out/index.html
        - echo "ğŸ“„ ConteÃºdo inicial do index.html:"
        - head -10 out/index.html
        - echo "âœ… Build concluÃ­do com sucesso!"
        - echo "ğŸ¯ Frontend pronto para deploy no Amplify!"
  artifacts:
    baseDirectory: frontend/out
    files:
      - '**/*'
  cache:
    paths:
      - frontend/node_modules/**/*
      - frontend/.next/cache/**/*
