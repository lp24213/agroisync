version: 1
frontend:
  phases:
    preBuild:
      commands:
        - echo "ğŸš€ Iniciando build do AGROISYNC..."
        - cd frontend
        - echo "ğŸ§¹ Limpando arquivos anteriores..."
        - rm -rf .next node_modules out package-lock.json
        - echo "ğŸ“¦ Instalando dependÃªncias..."
        - npm ci
    build:
      commands:
        - cd frontend
        - echo "ğŸ”¨ Configurando Next.js para export estÃ¡tico..."
        - echo '{"output": "export", "trailingSlash": true, "images": {"unoptimized": true}}' > next.config.temp.json
        - echo "ğŸ”¨ Fazendo build estÃ¡tico..."
        - npm run build
        - echo "âœ… Build concluÃ­do com sucesso!"
        - echo "ğŸ“ Verificando arquivos gerados..."
        - ls -la out/
  artifacts:
    baseDirectory: frontend/out
    files:
      - '**/*'
  cache:
    paths:
      - frontend/node_modules/**/*
