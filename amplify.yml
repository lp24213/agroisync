version: 1
frontend:
  phases:
    preBuild:
      commands:
        - echo "ğŸš€ AGROISYNC - Build iniciado..."
        - cd frontend
        - echo "ğŸ§¹ Limpando arquivos anteriores..."
        - rm -rf .next node_modules out package-lock.json
        - echo "ğŸ“¦ Instalando dependÃªncias..."
        - npm ci
        - echo "ğŸ”§ Verificando versÃµes..."
        - node --version
        - npm --version
    build:
      commands:
        - cd frontend
        - echo "ğŸ”¨ Fazendo build estÃ¡tico com configuraÃ§Ã£o final..."
        - npm run build:final
        - echo "âœ… Build concluÃ­do!"
        - echo "ğŸ“ Verificando arquivos gerados..."
        - ls -la out/
        - echo "ğŸ“Š Tamanho do diretÃ³rio out:"
        - du -sh out/
        - echo "ğŸ” Verificando se index.html existe:"
        - test -f out/index.html && echo "âœ… index.html encontrado!" || echo "âŒ index.html NÃƒO encontrado!"
  artifacts:
    baseDirectory: frontend/out
    files:
      - '**/*'
  cache:
    paths:
      - frontend/node_modules/**/*
      - frontend/.next/cache/**/*
