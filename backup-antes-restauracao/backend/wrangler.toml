
name = "agroisync-backend"
main = "src/worker.js"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]
workers_dev = true
minify = true
keep_vars = true
type = "javascript"
usage_model = "bundled"

[[d1_databases]]
binding = "DB"
database_name = "agroisync-db"
database_id = "a3eb1069-9c36-4689-9ee9-971245cb2d12"
migrations_dir = "./migrations"
preview_database_id = "a3eb1069-9b5e4379b85f7d902f61ac23"

[[kv_namespaces]]
binding = "CACHE"
id = "a20a18eafe5d499a8c86541abfd8a091"
preview_id = "b6f2845c8b4d4268a74e6c891f509c12"

[[kv_namespaces]]
binding = "SESSIONS"
id = "13903703f9474a8181e852306a287eb7"
preview_id = "d8e3956c9b5e4379b85f7d902f61ac23"

[vars]
NODE_ENV = "production"
API_VERSION = "v1"
FRONTEND_URL = "https://agroisync.com"
API_URL = "https://api.agroisync.com"
LOG_LEVEL = "info"
ENABLE_METRICS = true
MAX_UPLOAD_SIZE = "10mb"
RATE_LIMIT_WINDOW = "15m"
RATE_LIMIT_MAX = 100
CF_TURNSTILE_SITE_KEY = "0x4AAAAAAAQ8VKGsaXcsV7Rd"
CF_TURNSTILE_ENABLED = true
RESEND_FROM_EMAIL = "notifications@agroisync.com"
RESEND_DOMAIN = "agroisync.com"
RESEND_ENABLED = true
EMAIL_RETRY_ATTEMPTS = 3
EMAIL_RETRY_DELAY = "5s"
JWT_EXPIRES_IN = "7d"
JWT_REFRESH_EXPIRES_IN = "30d"
PASSWORD_MIN_LENGTH = 10
PASSWORD_HASH_ROUNDS = 12
SESSION_TIMEOUT = "24h"
CORS_ALLOWED_ORIGINS = ["https://agroisync.com", "https://www.agroisync.com"]
ENABLE_CSRF = true
SECURE_HEADERS = true
XSS_PROTECTION = true

[[routes]]
pattern = "agroisync.com/api/*"
zone_name = "agroisync.com"

[[routes]]
pattern = "www.agroisync.com/api/*"
zone_name = "agroisync.com"

[[routes]]
pattern = "agroisync.com/payment/*"
zone_name = "agroisync.com"

[[routes]]
pattern = "www.agroisync.com/payment/*"
zone_name = "agroisync.com"

[[routes]]
pattern = "agroisync.com/public/*"
zone_name = "agroisync.com"

[[routes]]
pattern = "www.agroisync.com/public/*"
zone_name = "agroisync.com"
