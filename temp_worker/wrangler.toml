name = "agroisync-api"
main = "src/worker.js"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]

workers_dev = true
minify = true

# Banco de dados D1
[[d1_databases]]
binding = "DB"
database_name = "agroisync-db"
database_id = "a3eb1069-9c36-4689-9ee9-971245cb2d12"

# KV para sessões
[[kv_namespaces]]
binding = "SESSIONS"
id = "13903703f9474a8181e852306a287eb7"

# Variáveis de ambiente
[vars]
NODE_ENV = "production"
API_VERSION = "v1"
FRONTEND_URL = "https://agroisync.com"
API_URL = "https://api.agroisync.com"
LOG_LEVEL = "info"
ENABLE_METRICS = true
MAX_UPLOAD_SIZE = "10mb"
RATE_LIMIT_WINDOW = "15m"
RATE_LIMIT_MAX = 100

# Cloudflare Turnstile
CF_TURNSTILE_SITE_KEY = "0x4AAAAAAAQ8VKGsaXcsV7Rd"
CF_TURNSTILE_SECRET_KEY = "0x4AAAAAAAQ8VKM1v9McyDNHxtRGW5TvXB"
CF_TURNSTILE_TIMEOUT = "30s"
CF_TURNSTILE_ENABLED = true

# Resend Email
RESEND_API_KEY = "re_V6N2kpHS_NXzW8Q9jHEhzpHGbJ8QXuZmK"
RESEND_FROM_EMAIL = "notifications@agroisync.com"
RESEND_DOMAIN = "agroisync.com"
RESEND_ENABLED = true
EMAIL_RETRY_ATTEMPTS = 3
EMAIL_RETRY_DELAY = "5s"

# JWT e Segurança
JWT_SECRET = "e12b49f8c2d3a6b7890123456789abcdef012345678901234567890abcd"
JWT_EXPIRES_IN = "7d"
JWT_REFRESH_SECRET = "f98e12b49c2d3a6b7890123456789abcdef012345678901234567890abcd"
JWT_REFRESH_EXPIRES_IN = "30d"
PASSWORD_MIN_LENGTH = 10
PASSWORD_HASH_ROUNDS = 12
SESSION_TIMEOUT = "24h"
CORS_ALLOWED_ORIGINS = ["https://agroisync.com", "https://www.agroisync.com", "https://fix-all-functional-issues-pr.agroisync.pages.dev"]
ENABLE_CSRF = true
SECURE_HEADERS = true
XSS_PROTECTION = true