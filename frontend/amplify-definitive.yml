version: 1
frontend:
  phases:
    preBuild:
      commands:
        - echo "ğŸš€ Iniciando build do AGROISYNC Frontend..."
        - echo "ğŸ“‹ VersÃµes do sistema:"
        - node --version
        - npm --version
        - echo "ğŸ“¦ Instalando dependÃªncias..."
        - npm ci
        - echo "âš™ï¸ Configurando Next.js para Amplify..."
        - cp next.config-final.js next.config.js
        - cp tsconfig-amplify.json tsconfig.json
        - echo "ğŸ”§ ConfiguraÃ§Ãµes aplicadas com sucesso"
        - echo "ğŸ“ Estrutura atual:"
        - ls -la
    build:
      commands:
        - echo "ğŸ—ï¸ Buildando aplicaÃ§Ã£o..."
        - npm run build
        - echo "ğŸ“ Verificando estrutura apÃ³s build..."
        - pwd
        - ls -la
        - echo "ğŸ“ Verificando pasta out..."
        - ls -la out/
        - echo "ğŸ“„ Verificando index.html..."
        - ls -la out/index.html
        - echo "ğŸ“„ ConteÃºdo inicial do index.html:"
        - head -10 out/index.html
        - echo "âœ… Build concluÃ­do com sucesso!"
        - echo "ğŸ¯ Arquivos prontos para deploy no Amplify!"
  artifacts:
    baseDirectory: out
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
      - .next/cache/**/*
